<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Calculadora</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
      :root{--bg:#0f172a;--card:#111827;--text:#e5e7eb;--muted:#1f2937;--accent:#f59e0b;--danger:#ef4444;--mutedText:#9ca3af;--border:#334155}
      *{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif}
      .container{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px}
      .card{width:100%;max-width:360px;background:var(--card);border:1px solid var(--border);border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.35);padding:16px}
      .row{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
      .btn{height:48px;border:none;border-radius:10px;color:#fff;font-size:18px;font-weight:600;background:#374151;cursor:pointer;transition:.15s transform,.15s filter}
      .btn:hover{filter:brightness(1.08)} .btn:active{transform:scale(.98)}
      .btn.op{background:#ea580c} .btn.danger{background:var(--danger)} .btn.gray{background:#6b7280}
      .btn.w2{grid-column:span 2}
      .display{background:var(--muted);border:1px solid var(--border);border-radius:10px;padding:14px 12px;margin:10px 0 14px;text-align:right}
      .display-main{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;font-size:28px;word-break:break-all}
      .display-sub{color:var(--accent);font-size:12px;margin-top:4px}
      .header{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
      .title{font-size:18px;font-weight:600}
      .icon-btn{background:transparent;border:none;color:var(--mutedText);cursor:pointer;padding:6px;border-radius:8px}
      .icon-btn:hover{background:rgba(148,163,184,.15);color:var(--text)}
    </style>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.client.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body>
    <div id="root" class="container"></div>
    <script type="text/babel">
      const { useState } = React;

      function Calculator() {
        const [display, setDisplay] = useState("0");
        const [previousValue, setPreviousValue] = useState(null);
        const [operation, setOperation] = useState(null);
        const [waitingForOperand, setWaitingForOperand] = useState(false);

        const MAX = 12;

        const format = (value) => {
          if (!isFinite(value)) return value > 0 ? "Infinity" : "-Infinity";
          if (Number.isNaN(value)) return "Error";
          const s = String(value);
          if (s.length <= MAX) return s;
          if (s.includes('.')) {
            const [i,d] = s.split('.');
            const avail = MAX - i.length - 1;
            if (avail > 0) return value.toFixed(Math.min(avail, d.length));
          }
          return value.toExponential(6);
        };

        const inputNumber = (num) => {
          if (waitingForOperand) { setDisplay(num); setWaitingForOperand(false); return; }
          const nd = display === "0" ? num : display + num;
          const eff = nd.replace('.', '').replace('-', '').length;
          if (eff <= MAX) setDisplay(nd);
        };

        const calc = (a,b,op) => ({'+':a+b,'-':a-b,'*':a*b,'/':a/b,'=':b}[op] ?? b);

        const inputOperation = (op) => {
          const val = parseFloat(display);
          if (previousValue === null) setPreviousValue(val);
          else if (operation) {
            const nv = calc(previousValue ?? 0, val, operation);
            setDisplay(format(nv));
            setPreviousValue(nv);
          }
          setOperation(op);
          setWaitingForOperand(true);
        };

        const perform = () => {
          const val = parseFloat(display);
          if (previousValue !== null && operation) {
            const nv = calc(previousValue, val, operation);
            setDisplay(format(nv));
            setPreviousValue(null);
            setOperation(null);
            setWaitingForOperand(true);
          }
        };

        const clear = () => { setDisplay("0"); setPreviousValue(null); setOperation(null); setWaitingForOperand(false); };
        const back = () => { setDisplay(d => d.length > 1 ? d.slice(0,-1) : "0"); };

        const Btn = ({label, onClick, className=""}) => (
          <button className={`btn ${className}`} onClick={onClick}>{label}</button>
        );

        return (
          <div className="card">
            <div className="header">
              <div className="title">Calculadora</div>
              <button className="icon-btn" title="Apagar" onClick={back}>←</button>
            </div>
            <div className="display">
              <div className="display-main">{display}</div>
              {(operation && previousValue !== null) && (
                <div className="display-sub">{previousValue} {operation}</div>
              )}
            </div>
            <div className="row">
              <Btn label="C" className="danger" onClick={clear} />
              <Btn label="←" className="gray" onClick={back} />
              <Btn label="÷" className="op w2" onClick={() => inputOperation('/')} />

              <Btn label="7" onClick={() => inputNumber('7')} />
              <Btn label="8" onClick={() => inputNumber('8')} />
              <Btn label="9" onClick={() => inputNumber('9')} />
              <Btn label="×" className="op" onClick={() => inputOperation('*')} />

              <Btn label="4" onClick={() => inputNumber('4')} />
              <Btn label="5" onClick={() => inputNumber('5')} />
              <Btn label="6" onClick={() => inputNumber('6')} />
              <Btn label="-" className="op" onClick={() => inputOperation('-')} />

              <Btn label="1" onClick={() => inputNumber('1')} />
              <Btn label="2" onClick={() => inputNumber('2')} />
              <Btn label="3" onClick={() => inputNumber('3')} />
              <Btn label="+" className="op" onClick={() => inputOperation('+')} />

              <Btn label="0" className="w2" onClick={() => inputNumber('0')} />
              <Btn label="," onClick={() => !String(display).includes('.') && inputNumber('.')} />
              <Btn label="=" className="op" onClick={perform} />
            </div>
          </div>
        );
      }

      function App(){
        return (
          <div className="container">
            <Calculator />
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  </body>
</html>


